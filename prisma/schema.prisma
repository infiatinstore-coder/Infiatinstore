// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// ========================
// USER & AUTH
// ========================

model User {
  id              String    @id @default(uuid())
  email           String?   @unique // Optional - can register with phone only
  passwordHash    String    @map("password_hash")
  name            String
  phone           String?
  avatarUrl       String?   @map("avatar_url")
  role            UserRole  @default(CUSTOMER)
  status          UserStatus @default(ACTIVE)
  emailVerifiedAt DateTime? @map("email_verified_at")
  
  // Email verification
  verificationToken        String?   @map("verification_token")
  verificationTokenExpires DateTime? @map("verification_token_expires")
  
  // Password reset
  resetPasswordToken   String?   @map("reset_password_token")
  resetPasswordExpires DateTime? @map("reset_password_expires")
  
  createdAt       DateTime  @default(now()) @map("created_at")
  updatedAt       DateTime  @updatedAt @map("updated_at")

  // Relations
  addresses       Address[]
  orders          Order[]
  carts           Cart[]
  reviews         Review[]
  notifications   Notification[]
  wishlist        Wishlist[]
  points          UserPoints?
  pointHistory    PointTransaction[]
  chatMessages    ChatMessage[]
  productQuestions ProductQuestion[]
  refundRequests  RefundRequest[]
  otpVerifications OTPVerification[]

  @@map("users")
}

enum UserRole {
  CUSTOMER
  ADMIN
  SUPER_ADMIN
}

enum UserStatus {
  ACTIVE
  SUSPENDED
  UNVERIFIED
}

// ========================
// ADDRESS
// ========================

model Address {
  id            String   @id @default(uuid())
  userId        String   @map("user_id")
  label         String   @default("HOME") // HOME, OFFICE, OTHER
  recipientName String   @map("recipient_name")
  phone         String
  fullAddress   String   @map("full_address")
  province      String
  city          String
  district      String
  postalCode    String   @map("postal_code")
  isDefault     Boolean  @default(false) @map("is_default")
  createdAt     DateTime @default(now()) @map("created_at")

  // Relations
  user   User    @relation(fields: [userId], references: [id], onDelete: Cascade)
  orders Order[]

  @@map("addresses")
}

// ========================
// PRODUCT
// ========================

model Category {
  id          String    @id @default(uuid())
  name        String
  slug        String    @unique
  description String?
  imageUrl    String?   @map("image_url")
  parentId    String?   @map("parent_id")
  createdAt   DateTime  @default(now()) @map("created_at")

  // Relations
  parent   Category?  @relation("CategoryHierarchy", fields: [parentId], references: [id])
  children Category[] @relation("CategoryHierarchy")
  products Product[]

  @@map("categories")
}

model Product {
  id          String        @id @default(uuid())
  name        String
  slug        String        @unique
  description String        @db.Text
  categoryId  String        @map("category_id")
  basePrice   Decimal       @map("base_price") @db.Decimal(12, 2)
  salePrice   Decimal?      @map("sale_price") @db.Decimal(12, 2)
  stock       Int           @default(0)
  weight      Int           @default(0) // in grams
  dimensions  Json?         // { length, width, height }
  images      Json          // array of image URLs
  seoMetadata Json?         @map("seo_metadata")
  status      ProductStatus @default(ACTIVE)
  isFeatured  Boolean       @default(false) @map("is_featured")
  createdAt   DateTime      @default(now()) @map("created_at")
  updatedAt   DateTime      @updatedAt @map("updated_at")

  // Relations
  category    Category           @relation(fields: [categoryId], references: [id])
  variants    ProductVariant[]
  cartItems   Cart[]
  orderItems  OrderItem[]
  reviews     Review[]
  wishlist    Wishlist[]
  flashSales  FlashSaleProduct[]
  questions   ProductQuestion[]
  bundles     BundleProduct[]

  @@index([categoryId])
  @@index([status])
  @@index([isFeatured])
  @@index([createdAt])
  @@map("products")
}

enum ProductStatus {
  ACTIVE
  INACTIVE
  SOLD_OUT
  ARCHIVED
}

model ProductVariant {
  id              String  @id @default(uuid())
  productId       String  @map("product_id")
  name            String  // e.g., "Size L - Red"
  sku             String  @unique
  priceAdjustment Decimal @default(0) @map("price_adjustment") @db.Decimal(12, 2)
  stock           Int     @default(0)
  attributes      Json    // { size: "L", color: "Red" }

  // Relations
  product    Product     @relation(fields: [productId], references: [id], onDelete: Cascade)
  cartItems  Cart[]
  orderItems OrderItem[]

  @@map("product_variants")
}

// ========================
// CART
// ========================

model Cart {
  id        String   @id @default(uuid())
  userId    String?  @map("user_id")
  sessionId String?  @map("session_id") // for guest users
  productId String   @map("product_id")
  variantId String?  @map("variant_id")
  quantity  Int
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  // Relations
  user    User?           @relation(fields: [userId], references: [id], onDelete: Cascade)
  product Product         @relation(fields: [productId], references: [id], onDelete: Cascade)
  variant ProductVariant? @relation(fields: [variantId], references: [id], onDelete: Cascade)

  @@unique([userId, productId, variantId])
  @@map("carts")
}

// ========================
// ORDER
// ========================

model Order {
  id              String      @id @default(uuid())
  orderNumber     String      @unique @map("order_number")
  userId          String?     @map("user_id") // Nullable for guest checkout
  addressId       String?     @map("address_id") // Nullable for guest checkout
  
  // Guest checkout fields (required when userId is null)
  guestEmail      String?     @map("guest_email")
  guestPhone      String?     @map("guest_phone")
  guestName       String?     @map("guest_name")
  
  subtotal        Decimal     @db.Decimal(12, 2)
  shippingCost    Decimal     @map("shipping_cost") @db.Decimal(12, 2)
  discount        Decimal     @default(0) @db.Decimal(12, 2)
  tax             Decimal     @default(0) @db.Decimal(12, 2) // PPN 11%
  total           Decimal     @db.Decimal(12, 2)
  paymentMethod   String?     @map("payment_method")
  shippingMethod  String?     @map("shipping_method")
  courierService  String?     @map("courier_service")
  notes           String?     @db.Text
  idempotencyKey  String?     @map("idempotency_key") // For preventing duplicate orders
  status          OrderStatus @default(PENDING_PAYMENT)
  createdAt       DateTime    @default(now()) @map("created_at")
  updatedAt       DateTime    @updatedAt @map("updated_at")

  // Relations
  user           User?           @relation(fields: [userId], references: [id])
  address        Address?        @relation(fields: [addressId], references: [id])
  items          OrderItem[]
  payment        Payment?
  shipment       Shipment?
  // refund      Refund? (Deprecated, see RefundRequest)
  refundRequests RefundRequest[]

  @@index([userId])
  @@index([status])
  @@index([createdAt])
  @@index([userId, idempotencyKey]) // For duplicate detection
  @@index([guestEmail]) // For guest order lookup
  @@map("orders")
}

enum OrderStatus {
  DRAFT
  PENDING_PAYMENT
  PAID
  PROCESSING
  SHIPPED
  DELIVERED        // DEPRECATED - kept for backward compatibility
  COMPLETED
  CANCELLED
  FAILED           // NEW - payment failed permanently
  REFUNDED         // DEPRECATED - out of scope, kept for backward compatibility
}

model OrderItem {
  id              String  @id @default(uuid())
  orderId         String  @map("order_id")
  productId       String  @map("product_id")
  variantId       String? @map("variant_id")
  productName     String  @map("product_name")
  variantName     String? @map("variant_name")
  quantity        Int
  priceAtPurchase Decimal @map("price_at_purchase") @db.Decimal(12, 2)
  subtotal        Decimal @db.Decimal(12, 2)

  // Relations
  order   Order           @relation(fields: [orderId], references: [id], onDelete: Cascade)
  product Product         @relation(fields: [productId], references: [id])
  variant ProductVariant? @relation(fields: [variantId], references: [id])

  @@map("order_items")
}

// ========================
// PAYMENT
// ========================

model Payment {
  id                   String        @id @default(uuid())
  orderId              String        @unique @map("order_id")
  paymentMethod        String        @map("payment_method")
  amount               Decimal       @db.Decimal(12, 2)
  status               PaymentStatus @default(PENDING)
  paymentProofUrl      String?       @map("payment_proof_url")
  gatewayTransactionId String?       @map("gateway_transaction_id")
  gatewayResponse      Json?         @map("gateway_response")
  expiresAt            DateTime?     @map("expires_at")
  paidAt               DateTime?     @map("paid_at")
  createdAt            DateTime      @default(now()) @map("created_at")

  // Relations
  order Order @relation(fields: [orderId], references: [id], onDelete: Cascade)

  @@map("payments")
}

enum PaymentStatus {
  INIT
  PENDING
  SUCCESS
  FAILED
  EXPIRED
  REFUNDED
}

// ========================
// SHIPMENT
// ========================

model Shipment {
  id             String         @id @default(uuid())
  orderId        String         @unique @map("order_id")
  courier        String
  serviceType    String         @map("service_type")
  trackingNumber String?        @map("tracking_number")
  estimatedDays  Int?           @map("estimated_days")
  status         ShipmentStatus @default(PENDING)
  shippedAt      DateTime?      @map("shipped_at")
  deliveredAt    DateTime?      @map("delivered_at")
  createdAt      DateTime       @default(now()) @map("created_at")

  // Relations
  order Order @relation(fields: [orderId], references: [id], onDelete: Cascade)

  @@map("shipments")
}

enum ShipmentStatus {
  PENDING
  PICKED_UP
  IN_TRANSIT
  OUT_FOR_DELIVERY
  DELIVERED
  RETURNED
}

// ========================
// REFUND
// ========================
// REFUND (Deprecated - moved to RefundRequest)
// ========================


// ========================
// VOUCHER
// ========================

model Voucher {
  id          String        @id @default(uuid())
  code        String        @unique
  type        VoucherType
  value       Decimal       @db.Decimal(12, 2)
  minPurchase Decimal       @default(0) @map("min_purchase") @db.Decimal(12, 2)
  maxDiscount Decimal?      @map("max_discount") @db.Decimal(12, 2)
  usageLimit  Int?          @map("usage_limit")
  usedCount   Int           @default(0) @map("used_count")
  validFrom   DateTime      @map("valid_from")
  validUntil  DateTime      @map("valid_until")
  status      VoucherStatus @default(ACTIVE)
  createdAt   DateTime      @default(now()) @map("created_at")

  @@map("vouchers")
}

enum VoucherType {
  PERCENTAGE
  FIXED_AMOUNT
  FREE_SHIPPING
}

enum VoucherStatus {
  ACTIVE
  INACTIVE
  EXPIRED
}

// ========================
// REVIEW
// ========================

model Review {
  id           String       @id @default(uuid())
  productId    String       @map("product_id")
  userId       String       @map("user_id")
  rating       Int          // 1-5
  title        String?
  comment      String       @db.Text
  images       Json?        // array of image URLs
  helpfulCount Int          @default(0) @map("helpful_count")
  status       ReviewStatus @default(PENDING)
  createdAt    DateTime     @default(now()) @map("created_at")

  // Relations
  product  Product         @relation(fields: [productId], references: [id], onDelete: Cascade)
  user     User            @relation(fields: [userId], references: [id], onDelete: Cascade)
  helpfuls ReviewHelpful[]

  @@unique([productId, userId])
  @@map("reviews")
}

enum ReviewStatus {
  PENDING
  APPROVED
  REJECTED
}

// ========================
// NOTIFICATION
// ========================

model Notification {
  id        String   @id @default(uuid())
  userId    String   @map("user_id")
  type      String   // ORDER_STATUS, PROMO, SYSTEM
  title     String
  message   String   @db.Text
  data      Json?    // additional data
  readAt    DateTime? @map("read_at")
  createdAt DateTime @default(now()) @map("created_at")

  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("notifications")
}

// ========================
// WISHLIST
// ========================

model Wishlist {
  id        String   @id @default(uuid())
  userId    String   @map("user_id")
  productId String   @map("product_id")
  createdAt DateTime @default(now()) @map("created_at")

  // Relations
  user    User    @relation(fields: [userId], references: [id], onDelete: Cascade)
  product Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@unique([userId, productId])
  @@map("wishlists")
}

// ========================
// NEWSLETTER
// ========================

model NewsletterSubscriber {
  id          String             @id @default(uuid())
  email       String             @unique
  name        String?
  status      SubscriberStatus   @default(ACTIVE)
  subscribedAt DateTime          @default(now()) @map("subscribed_at")
  unsubscribedAt DateTime?       @map("unsubscribed_at")

  @@map("newsletter_subscribers")
}

enum SubscriberStatus {
  ACTIVE
  UNSUBSCRIBED
}

// ========================
// CONTACT MESSAGE
// ========================

model ContactMessage {
  id        String             @id @default(uuid())
  name      String
  email     String
  phone     String?
  subject   String
  message   String             @db.Text
  status    ContactStatus      @default(NEW)
  repliedAt DateTime?          @map("replied_at")
  createdAt DateTime           @default(now()) @map("created_at")

  @@map("contact_messages")
}

enum ContactStatus {
  NEW
  IN_PROGRESS
  RESOLVED
  CLOSED
}

// ========================
// REVIEW HELPFUL
// ========================

model ReviewHelpful {
  id        String   @id @default(uuid())
  reviewId  String   @map("review_id")
  userId    String   @map("user_id")
  createdAt DateTime @default(now()) @map("created_at")

  // Relations
  review Review @relation(fields: [reviewId], references: [id], onDelete: Cascade)

  @@unique([reviewId, userId])
  @@map("review_helpfuls")
}

// ========================
// ACTIVITY LOG
// ========================

model ActivityLog {
  id         String   @id @default(uuid())
  userId     String?  @map("user_id")
  action     String
  entityType String   @map("entity_type") // ORDER, PRODUCT, USER
  entityId   String   @map("entity_id")
  metadata   Json?
  ipAddress  String?  @map("ip_address")
  userAgent  String?  @map("user_agent")
  createdAt  DateTime @default(now()) @map("created_at")

  @@map("activity_logs")
}

// ========================
// FLASH SALE SYSTEM
// ========================

model FlashSale {
  id          String          @id @default(uuid())
  name        String
  slug        String          @unique
  description String?
  bannerUrl   String?         @map("banner_url")
  startTime   DateTime        @map("start_time")
  endTime     DateTime        @map("end_time")
  status      FlashSaleStatus @default(UPCOMING)
  createdAt   DateTime        @default(now()) @map("created_at")
  updatedAt   DateTime        @updatedAt @map("updated_at")

  // Relations
  products FlashSaleProduct[]

  @@map("flash_sales")
}

enum FlashSaleStatus {
  UPCOMING
  ACTIVE
  ENDED
}

model FlashSaleProduct {
  id          String   @id @default(uuid())
  flashSaleId String   @map("flash_sale_id")
  productId   String   @map("product_id")
  salePrice   Decimal  @map("sale_price") @db.Decimal(12, 2)
  stockLimit  Int      @map("stock_limit")
  soldCount   Int      @default(0) @map("sold_count")
  createdAt   DateTime @default(now()) @map("created_at")

  // Relations
  flashSale FlashSale @relation(fields: [flashSaleId], references: [id], onDelete: Cascade)
  product   Product   @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@unique([flashSaleId, productId])
  @@map("flash_sale_products")
}

model FlashSalePurchase {
  id                 String   @id @default(uuid())
  flashSaleProductId String   @map("flash_sale_product_id")
  userId             String   @map("user_id")
  quantity           Int
  createdAt          DateTime @default(now()) @map("created_at")

  @@unique([flashSaleProductId, userId])
  @@map("flash_sale_purchases")
}

// ========================
// POINTS / COIN SYSTEM
// ========================

model UserPoints {
  id        String   @id @default(uuid())
  userId    String   @unique @map("user_id")
  balance   Int      @default(0)
  lifetime  Int      @default(0) // total earned all time
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("user_points")
}

model PointTransaction {
  id          String            @id @default(uuid())
  userId      String            @map("user_id")
  type        PointTransactionType
  amount      Int               // positive = earn, negative = spend
  balance     Int               // balance after transaction
  description String
  orderId     String?           @map("order_id")
  expiresAt   DateTime?         @map("expires_at")
  createdAt   DateTime          @default(now()) @map("created_at")

  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("point_transactions")
}

enum PointTransactionType {
  EARN_PURCHASE    // earn from purchase
  EARN_REVIEW      // earn from writing review
  EARN_DAILY       // daily check-in
  EARN_MISSION     // complete mission
  EARN_REFERRAL    // referral bonus
  REDEEM           // redeem for discount
  EXPIRE           // points expired
  ADMIN_ADJUST     // admin adjustment
}

// ========================
// CHAT SYSTEM
// ========================

model ChatMessage {
  id        String    @id @default(uuid())
  orderId   String?   @map("order_id")
  userId    String    @map("user_id")
  message   String    @db.Text
  imageUrl  String?   @map("image_url")
  isAdmin   Boolean   @default(false) @map("is_admin")
  readAt    DateTime? @map("read_at")
  createdAt DateTime  @default(now()) @map("created_at")

  // Relations
  user User @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@map("chat_messages")
}

// ========================
// PRODUCT Q&A
// ========================

model ProductQuestion {
  id        String          @id @default(uuid())
  productId String          @map("product_id")
  userId    String          @map("user_id")
  question  String          @db.Text
  status    QuestionStatus  @default(PENDING)
  createdAt DateTime        @default(now()) @map("created_at")

  // Relations
  product Product         @relation(fields: [productId], references: [id], onDelete: Cascade)
  user    User            @relation(fields: [userId], references: [id], onDelete: Cascade)
  answers ProductAnswer[]

  @@map("product_questions")
}

model ProductAnswer {
  id         String   @id @default(uuid())
  questionId String   @map("question_id")
  answer     String   @db.Text
  isOfficial Boolean  @default(false) @map("is_official")
  createdAt  DateTime @default(now()) @map("created_at")

  // Relations
  question ProductQuestion @relation(fields: [questionId], references: [id], onDelete: Cascade)

  @@map("product_answers")
}

enum QuestionStatus {
  PENDING
  ANSWERED
  HIDDEN
}

// ========================
// BUNDLE DEALS
// ========================

model Bundle {
  id              String       @id @default(uuid())
  name            String
  slug            String       @unique
  description     String?
  imageUrl        String?      @map("image_url")
  discountType    DiscountType @default(PERCENTAGE) @map("discount_type")
  discountValue   Decimal      @map("discount_value") @db.Decimal(12, 2)
  minQuantity     Int          @default(2) @map("min_quantity") // minimum products to get discount
  isActive        Boolean      @default(true) @map("is_active")
  validFrom       DateTime?    @map("valid_from")
  validUntil      DateTime?    @map("valid_until")
  createdAt       DateTime     @default(now()) @map("created_at")
  updatedAt       DateTime     @updatedAt @map("updated_at")

  // Relations
  products BundleProduct[]

  @@map("bundles")
}

model BundleProduct {
  id        String   @id @default(uuid())
  bundleId  String   @map("bundle_id")
  productId String   @map("product_id")
  quantity  Int      @default(1) // quantity in bundle
  createdAt DateTime @default(now()) @map("created_at")

  // Relations
  bundle  Bundle  @relation(fields: [bundleId], references: [id], onDelete: Cascade)
  product Product @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@unique([bundleId, productId])
  @@map("bundle_products")
}

enum DiscountType {
  PERCENTAGE
  FIXED_AMOUNT
}

// ========================
// STOCK NOTIFICATION
// ========================

model StockNotification {
  id          String    @id @default(uuid())
  email       String
  productId   String    @map("product_id")
  productName String?   @map("product_name")
  notifiedAt  DateTime? @map("notified_at")
  createdAt   DateTime  @default(now()) @map("created_at")

  @@unique([email, productId])
  @@map("stock_notifications")
}
// ========================
// REFUND & RETURNS
// ========================

model RefundRequest {
  id              String        @id @default(uuid())
  orderId         String        @map("order_id")
  userId          String        @map("user_id")
  reason          String        @db.Text
  refundType      RefundType    @map("refund_type") @default(FULL)
  amount          Decimal       @db.Decimal(12, 2)
  status          RefundStatus  @default(PENDING)
  evidence        Json?         // Photos/documents
  adminNotes      String?       @db.Text @map("admin_notes")
  resolvedBy      String?       @map("resolved_by")
  resolvedAt      DateTime?     @map("resolved_at")
  rejectedReason  String?       @db.Text @map("rejected_reason")
  createdAt       DateTime      @default(now()) @map("created_at")
  updatedAt       DateTime      @updatedAt @map("updated_at")

  // Relations
  order Order @relation(fields: [orderId], references: [id])
  user  User  @relation(fields: [userId], references: [id])

  @@map("refund_requests")
}

enum RefundType {
  FULL
  PARTIAL
}

enum RefundStatus {
  PENDING
  APPROVED
  REJECTED
  PROCESSING
  COMPLETED
  CANCELLED
}

// ========================
// INVENTORY TRACKING
// ========================

model InventoryLog {
  id          String         @id @default(uuid())
  productId   String         @map("product_id")
  variantId   String?        @map("variant_id")
  type        InventoryType
  quantity    Int            // +/- value
  quantityBefore Int         @map("quantity_before")
  quantityAfter  Int         @map("quantity_after")
  orderId     String?        @map("order_id")
  userId      String?        @map("user_id")
  notes       String?        @db.Text
  createdAt   DateTime       @default(now()) @map("created_at")

  @@index([productId])
  @@index([createdAt])
  @@map("inventory_logs")
}

enum InventoryType {
  SALE           // Stock berkurang karena penjualan
  SALE_CANCELLED // Stock kembali karena order dibatalkan
  RESTOCK        // Admin tambah stock
  ADJUSTMENT     // Admin koreksi manual
  RETURN         // Customer return barang
  DAMAGED        // Barang rusak
}

// ========================
// PAYMENT LOGGING
// ========================

model PaymentLog {
  id              String    @id @default(uuid())
  orderId         String    @map("order_id")
  transactionId   String    @unique @map("transaction_id") // Midtrans order_id
  paymentType     String    @map("payment_type")
  grossAmount     Decimal   @db.Decimal(12, 2) @map("gross_amount")
  status          String    // settlement, pending, deny, cancel, expire
  fraudStatus     String?   @map("fraud_status")
  signatureKey    String?   @db.Text @map("signature_key")
  rawResponse     Json      @map("raw_response") // Full webhook payload
  processedAt     DateTime  @default(now()) @map("processed_at")
  
  @@index([orderId])
  @@index([transactionId])
  @@map("payment_logs")
}

// ========================
// ORDER STATE TRACKING
// ========================

model OrderStateLog {
  id          String      @id @default(uuid())
  orderId     String      @map("order_id")
  fromStatus  OrderStatus? @map("from_status")
  toStatus    OrderStatus @map("to_status")
  changedBy   String?     @map("changed_by") // userId or 'SYSTEM'
  reason      String?     @db.Text
  metadata    Json?       // Extra data (tracking number, etc)
  createdAt   DateTime    @default(now()) @map("created_at")

  @@index([orderId])
  @@index([createdAt])
  @@map("order_state_logs")
}

// ========================
// SYSTEM SETTINGS
// ========================

model Setting {
  id          String   @id @default(uuid())
  key         String   @unique
  value       String   @db.Text
  description String?
  isPublic    Boolean  @default(false) @map("is_public")
  updatedAt   DateTime @updatedAt @map("updated_at")

  @@map("settings")
}

// ========================
// OTP VERIFICATION
// ========================

model OTPVerification {
  id        String   @id @default(uuid())
  userId    String?  @map("user_id")
  user      User?    @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  phone     String   // Target phone number
  otp       String   // Hashed OTP code
  type      String   // 'REGISTRATION', 'LOGIN', 'PASSWORD_RESET'
  
  attempts  Int      @default(0) // Failed verification attempts
  verified  Boolean  @default(false)
  
  expiresAt DateTime @map("expires_at")
  createdAt DateTime @default(now()) @map("created_at")

  @@index([phone])
  @@index([userId])
  @@index([expiresAt])
  @@map("otp_verifications")
}
